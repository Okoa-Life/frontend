{"ast":null,"code":"var _jsxFileName = \"/home/priscah/workshops/react/src/Modal.js\",\n  _s = $RefreshSig$();\nimport { useContext, useEffect, useState } from \"react\";\nimport { setDoc, uploadFile } from \"@junobuild/core\";\nimport { AuthContext } from \"./Auth\";\nimport { nanoid } from \"nanoid\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nexport const Modal = () => {\n  _s();\n  const [showModal, setShowModal] = useState(false);\n  const [inputText, setInputText] = useState(\"\");\n  const [valid, setValid] = useState(false);\n  const [progress, setProgress] = useState(false);\n  const [file, setFile] = useState();\n  const {\n    user\n  } = useContext(AuthContext);\n  useEffect(() => {\n    setValid(inputText !== \"\" && user !== undefined && user !== null);\n  }, [showModal, inputText, user]);\n  const reload = () => {\n    let event = new Event(\"reload\");\n    window.dispatchEvent(event);\n  };\n  const add = async () => {\n    // Demo purpose therefore edge case not properly handled\n    if ([null, undefined].includes(user)) {\n      return;\n    }\n    setProgress(true);\n    try {\n      let url;\n      if (file !== undefined) {\n        const filename = `${user.key}-${file.name}`;\n\n        // TODO: STEP_7_UPLOAD_FILE\n        const {\n          downloadUrl\n        } = await uploadFile({\n          collection: \"images\",\n          data: file,\n          filename\n        });\n        url = downloadUrl;\n      }\n      const key = nanoid();\n\n      // TODO: STEP_5_SET_DOC\n      await setDoc({\n        collection: \"notes\",\n        doc: {\n          key,\n          data: {\n            text: inputText\n          }\n        }\n      });\n\n      // TODO: STEP_8_ADD_REFERENCE\n      // ...(url !== undefined && { url }),\n\n      setShowModal(false);\n      reload();\n    } catch (err) {\n      console.error(err);\n    }\n    setProgress(false);\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-10 flex items-center justify-center gap-x-6\",\n      children: /*#__PURE__*/_jsxDEV(\"button\", {\n        type: \"button\",\n        onClick: () => setShowModal(true),\n        className: \"rounded-md bg-indigo-600 px-3.5 py-1.5 text-base font-semibold leading-7 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600\",\n        children: \"Add an entry\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 77,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 7\n    }, this), showModal ? /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"justify-center items-center flex overflow-x-hidden overflow-y-auto fixed inset-0 z-50 outline-none focus:outline-none\",\n        children: /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"relative w-auto my-6 mx-auto max-w-3xl\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"border-0 rounded-lg shadow-lg relative flex flex-col w-full bg-white outline-none focus:outline-none\",\n            children: [/*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"relative p-6 flex-auto\",\n              children: [/*#__PURE__*/_jsxDEV(\"textarea\", {\n                className: \" form-control block w-full px-3 py-1.5 text-base font-normal text-gray-700 bg-white bg-clip-padding border border-solid border-gray-300 rounded transition ease-in-out m-0 focus:text-gray-700 focus:bg-white focus:border-indigo-600 focus:outline-none resize-none \",\n                rows: \"5\",\n                placeholder: \"Your diary entry\",\n                onChange: e => {\n                  setInputText(e.target.value);\n                },\n                value: inputText,\n                disabled: progress\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 92,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"input\", {\n                type: \"file\",\n                className: \"my-4 text-slate-500 text-lg leading-relaxed\",\n                onChange: event => {\n                  var _event$target$files;\n                  return setFile((_event$target$files = event.target.files) === null || _event$target$files === void 0 ? void 0 : _event$target$files[0]);\n                },\n                disabled: progress\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 119,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 91,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"flex items-center justify-end p-6 border-t border-solid border-slate-200 rounded-b\",\n              children: progress ? /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"animate-spin inline-block w-6 h-6 border-[3px] border-current border-t-transparent text-indigo-600 rounded-full\",\n                role: \"status\",\n                \"aria-label\": \"loading\",\n                children: /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"sr-only\",\n                  children: \"Loading...\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 134,\n                  columnNumber: 23\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 129,\n                columnNumber: 21\n              }, this) : /*#__PURE__*/_jsxDEV(_Fragment, {\n                children: [/*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"background-transparent font-bold uppercase px-6 py-2 text-sm outline-none focus:outline-none ease-linear transition-all duration-150\",\n                  type: \"button\",\n                  onClick: () => setShowModal(false),\n                  children: \"Close\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 138,\n                  columnNumber: 23\n                }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n                  className: \"rounded-md bg-indigo-600 px-3.5 py-1.5 text-base font-semibold leading-7 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:opacity-25\",\n                  type: \"button\",\n                  onClick: add,\n                  disabled: !valid,\n                  children: \"Submit\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 146,\n                  columnNumber: 23\n                }, this)]\n              }, void 0, true)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 127,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 90,\n            columnNumber: 15\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 89,\n          columnNumber: 13\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"opacity-25 fixed inset-0 z-40 bg-black\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 160,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true) : null]\n  }, void 0, true);\n};\n_s(Modal, \"IA4VjL0HSO9h+r0KQpZBrvEBYnU=\");\n_c = Modal;\nvar _c;\n$RefreshReg$(_c, \"Modal\");","map":{"version":3,"names":["useContext","useEffect","useState","setDoc","uploadFile","AuthContext","nanoid","Modal","showModal","setShowModal","inputText","setInputText","valid","setValid","progress","setProgress","file","setFile","user","undefined","reload","event","Event","window","dispatchEvent","add","includes","url","filename","key","name","downloadUrl","collection","data","doc","text","err","console","error","e","target","value","files"],"sources":["/home/priscah/workshops/react/src/Modal.js"],"sourcesContent":["import { useContext, useEffect, useState } from \"react\";\nimport { setDoc, uploadFile } from \"@junobuild/core\";\nimport { AuthContext } from \"./Auth\";\nimport { nanoid } from \"nanoid\";\n\nexport const Modal = () => {\n  const [showModal, setShowModal] = useState(false);\n  const [inputText, setInputText] = useState(\"\");\n  const [valid, setValid] = useState(false);\n  const [progress, setProgress] = useState(false);\n  const [file, setFile] = useState();\n\n  const { user } = useContext(AuthContext);\n\n  useEffect(() => {\n    setValid(inputText !== \"\" && user !== undefined && user !== null);\n  }, [showModal, inputText, user]);\n\n  const reload = () => {\n    let event = new Event(\"reload\");\n    window.dispatchEvent(event);\n  };\n\n  const add = async () => {\n    // Demo purpose therefore edge case not properly handled\n    if ([null, undefined].includes(user)) {\n      return;\n    }\n\n    setProgress(true);\n\n    try {\n      let url;\n\n      if (file !== undefined) {\n        const filename = `${user.key}-${file.name}`;\n\n        // TODO: STEP_7_UPLOAD_FILE\n        const { downloadUrl } = await uploadFile({\n          collection: \"images\",\n          data: file,\n          filename,\n        });\n\n        url = downloadUrl;\n      }\n\n      const key = nanoid();\n\n      // TODO: STEP_5_SET_DOC\n      await setDoc({\n        collection: \"notes\",\n        doc: {\n          key,\n          data: {\n            text: inputText,\n          },\n        },\n      });\n\n      // TODO: STEP_8_ADD_REFERENCE\n      // ...(url !== undefined && { url }),\n\n      setShowModal(false);\n\n      reload();\n    } catch (err) {\n      console.error(err);\n    }\n\n    setProgress(false);\n  };\n\n  return (\n    <>\n      <div className=\"mt-10 flex items-center justify-center gap-x-6\">\n        <button\n          type=\"button\"\n          onClick={() => setShowModal(true)}\n          className=\"rounded-md bg-indigo-600 px-3.5 py-1.5 text-base font-semibold leading-7 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600\"\n        >\n          Add an entry\n        </button>\n      </div>\n\n      {showModal ? (\n        <>\n          <div className=\"justify-center items-center flex overflow-x-hidden overflow-y-auto fixed inset-0 z-50 outline-none focus:outline-none\">\n            <div className=\"relative w-auto my-6 mx-auto max-w-3xl\">\n              <div className=\"border-0 rounded-lg shadow-lg relative flex flex-col w-full bg-white outline-none focus:outline-none\">\n                <div className=\"relative p-6 flex-auto\">\n                  <textarea\n                    className=\"\n        form-control\n        block\n        w-full\n        px-3\n        py-1.5\n        text-base\n        font-normal\n        text-gray-700\n        bg-white bg-clip-padding\n        border border-solid border-gray-300\n        rounded\n        transition\n        ease-in-out\n        m-0\n        focus:text-gray-700 focus:bg-white focus:border-indigo-600 focus:outline-none\n        resize-none\n      \"\n                    rows=\"5\"\n                    placeholder=\"Your diary entry\"\n                    onChange={(e) => {\n                      setInputText(e.target.value);\n                    }}\n                    value={inputText}\n                    disabled={progress}\n                  ></textarea>\n                  <input\n                    type=\"file\"\n                    className=\"my-4 text-slate-500 text-lg leading-relaxed\"\n                    onChange={(event) => setFile(event.target.files?.[0])}\n                    disabled={progress}\n                  />\n                </div>\n\n                <div className=\"flex items-center justify-end p-6 border-t border-solid border-slate-200 rounded-b\">\n                  {progress ? (\n                    <div\n                      className=\"animate-spin inline-block w-6 h-6 border-[3px] border-current border-t-transparent text-indigo-600 rounded-full\"\n                      role=\"status\"\n                      aria-label=\"loading\"\n                    >\n                      <span className=\"sr-only\">Loading...</span>\n                    </div>\n                  ) : (\n                    <>\n                      <button\n                        className=\"background-transparent font-bold uppercase px-6 py-2 text-sm outline-none focus:outline-none ease-linear transition-all duration-150\"\n                        type=\"button\"\n                        onClick={() => setShowModal(false)}\n                      >\n                        Close\n                      </button>\n\n                      <button\n                        className=\"rounded-md bg-indigo-600 px-3.5 py-1.5 text-base font-semibold leading-7 text-white shadow-sm hover:bg-indigo-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600 disabled:opacity-25\"\n                        type=\"button\"\n                        onClick={add}\n                        disabled={!valid}\n                      >\n                        Submit\n                      </button>\n                    </>\n                  )}\n                </div>\n              </div>\n            </div>\n          </div>\n          <div className=\"opacity-25 fixed inset-0 z-40 bg-black\"></div>\n        </>\n      ) : null}\n    </>\n  );\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}